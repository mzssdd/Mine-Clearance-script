# 扫雷辅助工具

一个能够识别屏幕上的扫雷游戏并给出游戏提示的 Python 工具。

## 功能特性

- 🎯 自动识别屏幕上的扫雷游戏界面
- 🧠 智能分析当前棋盘状态
- 💡 给出安全格子和地雷位置提示
- 🖼️ 生成可视化提示图像

## 安装依赖

```bash
pip install -r requirements.txt
```

需要安装的库：

- `opencv-python`: 图像处理
- `numpy`: 数值计算
- `pyautogui`: 屏幕截图
- `Pillow`: 图像处理和绘制

## 使用方法

### 1. 启动工具

```bash
python minesweeper_solver.py
```

### 2. 操作步骤

1. **打开扫雷游戏**

   - 可以使用 Windows 自带的扫雷游戏
   - 或者在线扫雷游戏（如 minesweeper.online）

2. **准备扫描**

   - 确保扫雷游戏窗口可见
   - 游戏应该已经开始（有一些格子已经翻开）

3. **执行扫描**

   - 在终端输入 `s` 并回车
   - 将鼠标移动到扫雷游戏窗口
   - 等待 5 秒让程序捕获屏幕

4. **输入棋盘大小**

   - 初级：`9x9`
   - 中级：`16x16`
   - 高级：`16x30`
   - 自定义：按实际大小输入

5. **查看提示**
   - 程序会在终端显示安全格子和地雷位置
   - 同时生成 `minesweeper_hint.png` 图像文件
   - 打开图像查看详细标注

### 3. 提示说明

**终端输出：**

- 安全格子列表：建议点击的位置
- 地雷格子列表：建议标记的位置

**图像标注：**

- 🟢 绿色边框 + ✓ = 安全格子，可以点击
- 🔴 红色边框 + 💣 = 地雷格子，需要右键标记

## 使用示例

### Windows 扫雷游戏

1. 打开开始菜单，搜索"扫雷"
2. 开始一局新游戏，点击几个格子
3. 运行脚本：`python minesweeper_solver.py`
4. 输入 `s` 开始扫描
5. 根据棋盘难度输入大小（如 `9x9`）
6. 查看生成的提示图像

### 在线扫雷游戏

1. 访问 https://minesweeper.online/
2. 选择难度并开始游戏
3. 运行脚本并扫描
4. 按照提示继续游戏

## 技术原理

### 1. 图像识别

- 使用 OpenCV 进行屏幕截图
- 通过边缘检测和轮廓查找定位棋盘
- 分析每个格子的颜色和纹理识别状态

### 2. 逻辑求解

- 分析每个数字格周围的未翻开格子
- 应用扫雷基本规则：
  - 如果周围未知格子数 = 数字，则都是雷
  - 如果周围标记雷数 = 数字，其余都安全

### 3. 提示生成

- 在原始截图上绘制彩色边框
- 标注安全格子（绿色）和地雷格子（红色）
- 保存为 PNG 图像供用户参考

## 注意事项

⚠️ **重要提示：**

1. **识别准确性**

   - 当前版本使用简化的识别算法
   - 在不同游戏和显示设置下可能需要调整
   - 建议在标准扫雷游戏中使用

2. **棋盘大小**

   - 必须正确输入棋盘大小才能准确分析
   - 如果不确定，可以数一下游戏的行列数

3. **游戏进度**

   - 需要游戏已经开始（有格子翻开）
   - 完全未翻开的棋盘无法给出提示
   - 建议先随机点击几个格子

4. **屏幕分辨率**
   - 高分辨率屏幕可能需要调整识别参数
   - 确保游戏窗口清晰可见

## 改进方向

如需提高识别准确性，可以考虑：

1. **使用 OCR**

   - 集成 Tesseract OCR 识别数字
   - 提高数字识别准确率

2. **模板匹配**

   - 预先截取各种状态的格子作为模板
   - 使用模板匹配提高识别率

3. **深度学习**

   - 训练 CNN 模型识别格子状态
   - 实现更鲁棒的识别

4. **高级求解算法**
   - 实现概率分析
   - 处理需要猜测的情况

## 常见问题

**Q: 识别不准确怎么办？**
A: 确保游戏窗口清晰，尝试调整窗口大小，或在代码中调整识别阈值。

**Q: 找不到棋盘区域？**
A: 程序会使用整个屏幕，但可能影响准确性。建议游戏窗口占据屏幕中央较大区域。

**Q: 提示的格子位置不对？**
A: 检查输入的棋盘大小是否正确，确保与实际游戏一致。

**Q: 没有给出任何提示？**
A: 可能当前状态无法通过简单逻辑推断，需要更多信息或进行概率分析。

## 许可证

MIT License

## 免责声明

本工具仅供学习和研究使用，请勿用于作弊或违反游戏规则的行为。
