# 📝 更新日志

## 🎉 v3.1.0 - 和弦操作版本 (2025-01-XX)

### ⭐ 新增功能

#### 🎮 和弦操作（双击快速挖开）

**功能描述：**

类似Windows经典扫雷的和弦功能！当一个数字格子周围已经标记了足够数量的地雷时，双击该数字格子会自动翻开周围所有未标记的格子。

**使用条件：**
- ✅ 格子必须已经翻开并显示数字
- ✅ 周围标记的地雷数 = 该数字
- ❌ 如果标记错误会踩雷！

**技术实现：**

1. **核心逻辑** (`src/core/minesweeper_game.py`)
   - 新增 `chord_reveal(row, col)` 方法
   - 新增 `_get_neighbors(row, col)` 辅助方法
   - 实现条件检查和批量翻开逻辑

2. **界面交互** (`src/gui/game_board.py`)
   - `CellButton` 添加 `double_clicked` 信号
   - `GameBoard` 添加 `_on_cell_double_click()` 处理方法
   - 连接双击事件到和弦操作

3. **文档更新** (`使用指南.md`)
   - 添加详细的和弦操作说明
   - 提供使用示例和技巧

**使用效果：**
```
场景：数字1周围已标记1个雷
? ? ?        ? ✓ ✓
? 1 🚩  →双击→ ✓ 1 🚩
? ? ?        ? ✓ ✓
结果：自动翻开其他6个格子
```

**优势：**
- 🚀 大幅提升游戏速度
- 💪 减少重复点击
- 🎯 高手必备技能

---

## 🎉 v3.0.0 - AI智能解释版本 (2025-01-XX)

### ✨ 新增功能

#### 🤖 AI智能解释系统

**重大更新：每个地雷和安全格子都会有AI生成的自然语言解释！**

1. **智能推理解释**
   - 使用DeepSeek-V3大模型生成通俗易懂的解释
   - 每个提示都会说明"为什么"这个格子是地雷或安全
   - 帮助玩家理解AI的推理过程

2. **自然语言输出**
   ```
   🔴 地雷格子（建议标记）:
     1. 行3列4
        💣 数字3周围有3个未知格子且需要3个雷，
           所以这些格子必定是雷。
   ```

3. **学习模式**
   - 通过阅读AI解释学习扫雷技巧
   - 理解基本推理规则
   - 逐步提升自己的推理能力

### 🔧 技术改进

1. **求解器增强**
   - 新增推理依据记录功能
   - 每个结论都有详细的推理过程
   - 支持获取推理依据的API

2. **AI服务模块**
   - 新增 `src/utils/ai_service.py`
   - 集成硅基流动API
   - 使用DeepSeek-V3模型
   - 支持批量生成解释

3. **界面优化**
   - 提示信息显示AI解释
   - 减少单次显示数量（5个）提升可读性
   - 每个格子都有专门的解释行

### 📦 依赖更新

新增依赖：
- `requests>=2.28.0` - 用于API调用

### 🔐 API配置

- **服务商**: 硅基流动 (SiliconFlow)
- **模型**: DeepSeek-V3
- **API密钥**: 已内置（sk-c3104a3b952149aab0957280dd255eba）
- **接口**: https://api.siliconflow.cn/v1/chat/completions

### 📚 新增文档

- `AI功能说明.md` - AI功能详细说明
- `更新日志.md` - 版本更新记录

---

## 🎮 v2.0.0 - 内置游戏版本 (2025-01-XX)

### ✨ 核心功能重构

**重大改版：从"扫雷辅助工具"改为"内置扫雷游戏+AI提示"**

1. **完整的扫雷游戏**
   - 内置经典扫雷游戏逻辑
   - 三种难度：初级(9x9)、中级(16x16)、高级(16x30)
   - 第一次点击永远安全
   - 自动翻开空白区域

2. **游戏界面**
   - 现代化的格子按钮
   - 左键翻开，右键标记
   - 不同数字不同颜色
   - 游戏结束显示所有地雷

3. **AI提示系统**
   - 实时分析棋盘状态
   - 高亮显示安全格子（绿色）
   - 高亮显示地雷格子（红色）
   - 详细的位置信息

4. **游戏功能**
   - 计时器（记录游戏时间）
   - 地雷计数器（剩余地雷数）
   - 新游戏功能
   - 难度选择

### 🗑️ 移除功能

- 屏幕截图功能
- 图像识别功能
- 棋盘检测功能
- 所有图像处理相关代码

### 📦 新增文件

**核心模块:**
- `src/core/minesweeper_game.py` - 扫雷游戏逻辑
- `src/gui/game_board.py` - 游戏棋盘界面

**文档:**
- `README_NEW.md` - 新版本说明
- `使用指南.md` - 详细使用教程

### 🔧 技术栈

简化依赖：
- ✅ PySide6 - GUI框架
- ✅ NumPy - 数值计算
- ❌ OpenCV - 已移除
- ❌ PyAutoGUI - 已移除
- ❌ Pillow - 已移除（除了基础图像支持）

### 📁 项目结构

```
src/
├── core/
│   ├── minesweeper_game.py   # 新增：游戏逻辑
│   ├── solver.py              # 保留：AI求解器
│   └── board_analyzer.py      # 简化：棋盘分析
├── gui/
│   ├── game_board.py          # 新增：游戏界面
│   ├── main_window.py         # 重构：主窗口
│   └── widgets.py             # 保留：自定义组件
└── utils/
    ├── constants.py           # 更新：常量定义
    └── image_utils.py         # 简化：图像工具
```

---

## 📊 版本对比

| 功能 | v1.0 | v2.0 | v3.0 |
|------|------|------|------|
| 截图识别 | ✅ | ❌ | ❌ |
| 内置游戏 | ❌ | ✅ | ✅ |
| AI提示 | ✅ | ✅ | ✅ |
| AI解释 | ❌ | ❌ | ✅ |
| 推理依据 | ❌ | ❌ | ✅ |
| 自然语言 | ❌ | ❌ | ✅ |

---

## 🎯 升级指南

### 从 v2.0 升级到 v3.0

1. **拉取最新代码**
   ```bash
   git pull origin main
   ```

2. **安装新依赖**
   ```bash
   pip install requests
   ```
   或
   ```bash
   pip install -r requirements.txt
   ```

3. **启动游戏**
   ```bash
   python run.py
   ```

4. **体验新功能**
   - 点击"💡 AI提示"按钮
   - 查看右侧的AI解释
   - 学习推理过程

### 配置API密钥（可选）

如果需要使用自己的API密钥：

编辑 `src/gui/main_window.py`：
```python
self.ai_service = AIService("你的API密钥")
```

---

## 🐛 已知问题

### v3.0.0

- AI解释可能需要几秒钟时间（网络调用）
- 如果网络不好，会降级显示原始推理依据
- 每次显示最多5个格子的解释（避免界面过长）

### 解决方案

1. **响应慢**：减少显示数量或添加加载提示
2. **网络问题**：会自动降级，不影响基本使用
3. **API失效**：可更换自己的API密钥

---

## 🔮 未来计划

### v3.1.0 计划

- [ ] 添加加载动画
- [ ] 缓存AI解释结果
- [ ] 支持批量API调用
- [ ] 优化显示格式

### v4.0.0 展望

- [ ] 支持更多AI模型选择
- [ ] 添加推理过程可视化
- [ ] 多步推理链展示
- [ ] 支持自定义难度
- [ ] 添加游戏统计功能
- [ ] 实现排行榜系统

---

## 📞 反馈与支持

如有问题或建议，欢迎反馈！

**享受AI辅助的扫雷体验！** 🎮🤖✨


