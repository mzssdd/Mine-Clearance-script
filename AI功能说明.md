# 🤖 AI智能解释功能说明

## ✨ 新增功能

现在AI提示不仅会告诉你哪些格子是地雷，还会**用自然语言解释为什么**！

## 🎯 功能特点

### 1. 智能推理解释

每个被标记为地雷或安全的格子，都会显示详细的推理依据：

**示例输出：**

```
🔴 地雷格子（建议标记）:
  1. 行3列4
     💣 数字3周围有3个未知格子且需要3个雷，所以这些格子必定是雷。

  2. 行5列7
     💣 该位置周围的数字格已满足雷数要求，剩余格子必为地雷。
```

### 2. AI生成的自然语言

使用DeepSeek-V3大模型生成通俗易懂的解释，让你理解AI的推理过程。

### 3. 学习扫雷技巧

通过阅读AI的解释，你可以：
- 📚 学习扫雷的推理规则
- 🧠 理解逻辑推理过程
- 🎓 提升自己的扫雷技能

## 🔧 技术实现

### API配置

使用硅基流动（SiliconFlow）API：
- **模型**: DeepSeek-V3
- **API密钥**: 已内置（sk-c3104a3b952149aab0957280dd255eba）
- **接口**: https://api.siliconflow.cn/v1/chat/completions

### 推理逻辑

AI使用两条基本规则进行推理：

**规则1：确定地雷**
```
如果某个数字格子周围的【未知格子数】= 【剩余需要的地雷数】
→ 则所有未知格子都是地雷
```

**规则2：确定安全**
```
如果某个数字格子周围的【已标记地雷数】= 【数字】
→ 则剩余所有未知格子都是安全的
```

## 💡 使用方法

### 1. 开始游戏

正常玩扫雷游戏，翻开一些格子

### 2. 点击AI提示

点击窗口顶部的 **"💡 AI提示"** 按钮

### 3. 查看解释

右侧会显示详细的提示信息，包括：
- 📍 格子位置（行、列）
- 💡 AI生成的自然语言解释
- 🎯 推理依据

### 4. 根据提示操作

- 🟢 **绿色格子** - 根据解释理解为什么安全，然后点击
- 🔴 **红色格子** - 根据解释理解为什么是雷，然后标记

## 📊 显示格式

```
━━━━━━━━━━━━━━━
  AI 提示信息
━━━━━━━━━━━━━━━

📊 统计:
  安全格子: 2 个
  地雷格子: 3 个

🟢 安全格子（建议点击）:
  1. 行3列5
     💡 周围数字2已标记2个雷，所以这个格子是安全的。

🔴 地雷格子（建议标记）:
  1. 行4列6
     💣 数字3周围有3个未知格子且需要3个雷，所以这些格子必定是雷。
  
  2. 行5列7
     💣 基于周围数字的约束，该位置必然是地雷。
```

## ⚙️ 配置说明

### 修改API密钥

如果需要使用自己的API密钥，编辑 `src/gui/main_window.py`：

```python
# 在 MainWindow.__init__ 中修改
self.ai_service = AIService("你的API密钥")
```

### 调整显示数量

默认显示前5个格子的解释，可以在 `display_hint_info` 方法中修改：

```python
# 修改这两行的数字
for i, (row, col) in enumerate(safe_cells[:5], 1):  # 改为[:10]显示10个
for i, (row, col) in enumerate(mine_cells[:5], 1):  # 改为[:10]显示10个
```

## 🚀 性能优化

### API调用

- 每个格子单独调用API生成解释
- 超时时间：10秒
- 失败时显示原始推理依据

### 优化建议

如果AI响应较慢：
1. 减少显示的格子数量（默认5个）
2. 可以添加本地缓存机制
3. 可以批量调用API（需要修改代码）

## 🔍 故障排查

### Q: AI解释没有显示？

A: 可能原因：
- 网络连接问题
- API密钥失效
- API调用超时

此时会**自动降级**显示原始推理依据。

### Q: 解释内容不准确？

A: AI生成的解释基于原始推理依据，如果原始推理依据正确，解释应该是准确的。可以对比原始推理依据验证。

### Q: 想看原始推理依据？

A: 原始推理依据包含在代码的 `result['reason']` 中，格式如：
```
"位置(3,4)数字3，周围已标记0个雷，剩余3个未知格子=剩余3个雷，因此这些格子必定是雷"
```

## 📝 依赖包

确保安装了 `requests` 库：

```bash
pip install requests
```

或使用完整依赖：

```bash
pip install -r requirements.txt
```

## 🎓 学习价值

通过AI解释功能，你可以：

1. **理解推理过程** - 看懂AI是怎么得出结论的
2. **学习扫雷规则** - 掌握两条基本推理规则
3. **提升技能** - 逐渐不依赖AI也能自己推理
4. **验证想法** - 对比自己的推理和AI的推理

## 🌟 示例场景

### 场景1：简单推理

```
棋盘状态：
? ? ?
? 2 🚩
? 🚩 ?

AI解释：
"数字2周围已标记2个雷（等于数字），因此剩余格子必定安全。"
```

### 场景2：复杂推理

```
棋盘状态：
? ? ?
3 ? ?
🚩 ? ?

AI解释：
"数字3周围有3个未知格子且需要3个雷（已标记1个），所以剩余2个格子和已知1个雷共3个位置都是雷。"
```

## 🔮 未来改进

可能的功能增强：

- [ ] 支持更复杂的推理模式
- [ ] 添加推理过程的可视化
- [ ] 支持多步推理链的展示
- [ ] 添加推理难度评级
- [ ] 支持自定义AI模型选择

---

**享受AI辅助的扫雷学习体验！** 🎮🤖


